---
title: "Web Search 网络搜索"
description: "通过 PipeLLM Gateway 实时搜索网络"
i18n: "zh"
---

## 概述

PipeLLM WebSearch 通过 Gateway 提供实时网络搜索能力，按次计费。适用于 RAG（检索增强生成）和构建具有网络访问能力的 AI Agent。

## 接口

| 方法 | 端点                                          |
| ---- | --------------------------------------------- |
| GET  | `https://api.pipellm.com/v1/websearch/search` |

## 认证

在 `Authorization` 头中使用您的 PipeLLM API Key：

```
Authorization: Bearer YOUR_PIPELLM_API_KEY
```

## 请求参数

| 参数 | 类型   | 必填 | 描述       |
| ---- | ------ | ---- | ---------- |
| `q`  | string | 是   | 搜索关键词 |

### 请求示例

<Tabs>
  <Tab title="cURL">
```bash
curl -X GET "https://api.pipellm.com/v1/websearch/search?q=最新AI新闻" \
  -H "Authorization: Bearer $PIPELLM_API_KEY"
```
  </Tab>
  <Tab title="Python">
```python
import requests
import os

response = requests.get(
"https://api.pipellm.com/v1/websearch/search",
params={"q": "最新 AI 新闻"},
headers={"Authorization": f"Bearer {os.getenv('PIPELLM_API_KEY')}"}
)

data = response.json()
for result in data.get("data", {}).get("organic", []):
print(f"- {result['title']}: {result['link']}")

````
  </Tab>
  <Tab title="Node.js">
```javascript
const response = await fetch(
  "https://api.pipellm.com/v1/websearch/search?q=最新AI新闻",
  {
    headers: {
      Authorization: `Bearer ${process.env.PIPELLM_API_KEY}`,
    },
  }
);

const data = await response.json();
data.data.organic.forEach((result) => {
  console.log(`- ${result.title}: ${result.link}`);
});
````

  </Tab>
</Tabs>

## 响应格式

```json
{
  "code": 0,
  "message": "ok",
  "data": {
    "searchParameters": {
      "q": "最新AI新闻",
      "gl": "us",
      "hl": "en"
    },
    "answerBox": {
      "title": "精选摘要标题",
      "snippet": "Google 精选摘要的快速答案...",
      "link": "https://example.com/source"
    },
    "organic": [
      {
        "title": "搜索结果标题",
        "link": "https://example.com/page",
        "snippet": "页面描述或摘要..."
      }
    ]
  }
}
```

### 响应字段说明

| 字段                     | 类型    | 描述                       |
| ------------------------ | ------- | -------------------------- |
| `code`                   | integer | `0` 表示成功，非零表示错误 |
| `message`                | string  | 状态信息                   |
| `data.searchParameters`  | object  | 使用的搜索参数             |
| `data.answerBox`         | object  | Google 精选摘要（如果有）  |
| `data.organic`           | array   | 自然搜索结果列表           |
| `data.organic[].title`   | string  | 页面标题                   |
| `data.organic[].link`    | string  | 页面链接                   |
| `data.organic[].snippet` | string  | 页面描述                   |

### 错误响应

```json
{
  "code": 400,
  "message": "Bad Request, missing query parameter"
}
```

## 价格

| 项目     | 价格  |
| -------- | ----- |
| 每次请求 | $0.05 |

<Note>仅对成功的请求计费，失败请求不收费。</Note>

## 使用场景

### RAG 上下文增强

使用 WebSearch 为 LLM 提供实时上下文：

```python
import requests
import os
from openai import OpenAI

# 步骤 1: 搜索网络
search_response = requests.get(
    "https://api.pipellm.com/v1/websearch/search",
    params={"q": "OpenAI o3 模型能力"},
    headers={"Authorization": f"Bearer {os.getenv('PIPELLM_API_KEY')}"}
)
search_data = search_response.json()

# 步骤 2: 提取上下文
context = "\n".join([
    f"[{r['title']}]({r['link']}): {r['snippet']}"
    for r in search_data.get("data", {}).get("organic", [])[:5]
])

# 步骤 3: 与 LLM 结合使用
client = OpenAI(
    api_key=os.getenv("PIPELLM_API_KEY"),
    base_url="https://api.pipellm.com/v1"
)

response = client.chat.completions.create(
    model="gpt-4o",
    messages=[
        {"role": "system", "content": f"请基于以下上下文回答：\n{context}"},
        {"role": "user", "content": "OpenAI o3 有哪些主要特性？"}
    ]
)

print(response.choices[0].message.content)
```

## 速率限制

WebSearch 请求共享您账户的速率限制。如果收到 `503 Service Unavailable` 响应并带有 `Retry-After` 头，请等待后重试。
